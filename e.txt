  disk_metrics_cs = [
    for instance in values(data.aws_instance.instance_details) :
    [
      {
        # Fetch ALL CWAgent disk_used_percent metrics (all Linux paths/volumes) for this InstanceId
        expression = "SEARCH('Namespace=\"CWAgent\" MetricName=\"disk_used_percent\" InstanceId=\"${instance.id}\"', 'Average', 300)"
        id         = "disk_${replace(instance.id, "-", "_")}"
        label      = "%Disk - ${coalesce(instance.tags.Name, instance.id)}"
      }
    ]
    if contains(local.cs_instance_ids, instance.id)
  ]
