locals {
  # ALB TargetGroup HTTP & Latency (all target groups)
  # Counts use Sum; latency uses Average.
  alb_tg_http_metrics_search = [
    [
      {
        expression = "SEARCH('{AWS/ApplicationELB,TargetGroup} MetricName=\"HTTPCode_Target_3XX_Count\"', 'Sum', 60)"
        id         = "tg_3xx"
        label      = "ALB TG - HTTPCode_Target_3XX_Count"
      }
    ],
    [
      {
        expression = "SEARCH('{AWS/ApplicationELB,TargetGroup} MetricName=\"HTTPCode_Target_4XX_Count\"', 'Sum', 60)"
        id         = "tg_4xx"
        label      = "ALB TG - HTTPCode_Target_4XX_Count"
      }
    ],
    [
      {
        expression = "SEARCH('{AWS/ApplicationELB,TargetGroup} MetricName=\"HTTPCode_Target_5XX_Count\"', 'Sum', 60)"
        id         = "tg_5xx"
        label      = "ALB TG - HTTPCode_Target_5XX_Count"
      }
    ],
    [
      {
        expression = "SEARCH('{AWS/ApplicationELB,TargetGroup} MetricName=\"TargetResponseTime\"', 'Average', 60)"
        id         = "tg_trt"
        label      = "ALB TG - TargetResponseTime (s)"
      }
    ]
  ]

  # String for injecting into your local.final heredoc
  alb_tg_http_metrics_string = jsonencode(local.alb_tg_http_metrics_search)
}
