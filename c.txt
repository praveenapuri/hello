# Variable for the EC2 instance that will be the default target
variable "default_backup_runner_instance_id" {
  description = "The ID of the EC2 instance to use as the default target for the Route 53 backup."
  type        = string
}

# This resource creates the persistent link between your document and the target instance
resource "aws_ssm_association" "route53_backup_association" {
  name = aws_ssm_document.route53_backup_doc.name

  # This block defines the default target for the association
  targets {
    key    = "InstanceIds"
    values = [var.default_backup_runner_instance_id]
  }

  # Optional: You can also add a schedule to run this job automatically
  # schedule_expression = "cron(0 2 * * ? *)" # Runs every day at 2 AM UTC
}
