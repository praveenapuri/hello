Write-Host "Searching for all available Disk Metric Dimensions..." -ForegroundColor Cyan

# Fetches all variations of how Disk Space is being reported
$allMetrics = Get-CWMetricList -Namespace "CWAgent" -MetricName "LogicalDisk % Free Space"

$allMetrics | ForEach-Object {
    $dims = $_.Dimensions
    [PSCustomObject]@{
        MetricName = $_.MetricName
        Dimensions = ($dims | ForEach-Object { "$($_.Name)=$($_.Value)" }) -join " | "
    }
} | Out-GridView -Title "Search for your Instance IDs here"
